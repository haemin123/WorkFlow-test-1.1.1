import{c as T,j as e,P as j,S as L,T as w,A as M,r as m,K as R}from"./index-BWhNYll5.js";import{S as K,T as H,g as P}from"./TaskCard-hpMuFqCR.js";import{U as $}from"./user-C8BhFaIl.js";import"./trash-2-D4YKPC91.js";import"./calendar-DYNEwCHX.js";const U=T("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),F=T("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),q=T("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),_=({searchQuery:l,setSearchQuery:u,onlyMyTasks:g,setOnlyMyTasks:n,filterPriority:p,setFilterPriority:f,sortBy:a,setSortBy:b})=>{const x=()=>{const s=["NONE","SMART","DUE_DATE","PRIORITY"],o=(s.indexOf(a)+1)%s.length;b(s[o])};return e.jsxs("div",{className:"flex flex-col xl:flex-row xl:items-center justify-between gap-4 mb-6 px-2 flex-shrink-0",children:[e.jsxs("div",{className:"relative group w-full xl:w-72",children:[e.jsx(K,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",placeholder:"업무, 태그, 설명 검색...",className:"w-full bg-white pl-10 pr-8 py-2.5 rounded-full border border-gray-200 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all shadow-sm",value:l,onChange:s=>u(s.target.value)}),l&&e.jsx("button",{onClick:()=>u(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-300 hover:text-gray-500",children:e.jsx(q,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto pb-2 xl:pb-0 no-scrollbar",children:[e.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 text-gray-400 border-r border-gray-200 mr-2 hidden md:flex",children:[e.jsx(F,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-xs font-medium",children:"필터"})]}),e.jsxs("button",{onClick:()=>n(!g),className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium border transition-all whitespace-nowrap
                        ${g?"bg-blue-600 text-white border-blue-600 shadow-md shadow-blue-200":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:[e.jsx($,{className:"w-4 h-4"}),"내 업무"]}),e.jsx("div",{className:"flex bg-white rounded-full p-1 border border-gray-200 shadow-sm",children:["ALL",j.HIGH,j.MEDIUM,j.LOW].map(s=>e.jsx("button",{onClick:()=>f(s),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all whitespace-nowrap
                                ${p===s?"bg-gray-900 text-white shadow-sm":"text-gray-500 hover:bg-gray-100"}`,children:s==="ALL"?"전체":s===j.HIGH?"높음":s===j.MEDIUM?"중간":"낮음"},s))}),e.jsx("div",{className:"w-px h-6 bg-gray-200 mx-2 hidden md:block"}),e.jsxs("button",{onClick:x,className:`flex items-center gap-2 px-4 py-2 rounded-full text-sm font-medium border transition-all whitespace-nowrap min-w-[140px] justify-center
                        ${a!=="NONE"?"bg-indigo-50 text-indigo-600 border-indigo-100":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:[a==="SMART"?e.jsx(L,{className:"w-4 h-4 text-indigo-500"}):e.jsx(U,{className:"w-4 h-4"}),e.jsxs("span",{children:[a==="NONE"&&"정렬 없음",a==="SMART"&&"스마트 정렬",a==="DUE_DATE"&&"마감일순",a==="PRIORITY"&&"우선순위순"]})]})]})]})},z=({id:l,label:u,dotColor:g,tasks:n,draggedTaskId:p,dragOverColumn:f,onTaskClick:a,onDragStart:b,onDragEnd:x,onDragOver:s,onDragLeave:o,onDrop:y,onDeleteTask:D,onArchiveTask:h,onArchiveAll:v})=>{const i=f===l;return e.jsxs("div",{className:`w-[340px] flex flex-col h-full rounded-3xl transition-colors duration-300 ease-in-out px-2 py-2
            ${i?"bg-blue-50/60 ring-2 ring-blue-200 ring-inset":"bg-transparent"}
        `,onDragOver:d=>s(d,l),onDragLeave:o,onDrop:d=>y(d,l),children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 px-2 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${g}`}),e.jsx("h3",{className:"font-bold text-gray-700 text-sm",children:u})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[v&&n.length>0&&l===w.DONE&&e.jsxs("button",{onClick:()=>v(n),className:"flex items-center gap-1.5 px-2.5 py-1 text-[10px] font-bold text-indigo-600 bg-indigo-50 hover:bg-indigo-100 rounded-md transition-colors",title:"이 컬럼의 모든 업무 보관",children:[e.jsx(M,{className:"w-3 h-3"}),e.jsx("span",{children:"모두 보관"})]}),e.jsx("span",{className:`text-xs font-medium px-2.5 py-1 rounded-full transition-colors
                ${i?"bg-blue-200 text-blue-700":"bg-gray-100 text-gray-500"}
            `,children:n.length})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-1 space-y-4 pb-20 custom-scrollbar",children:[n.length===0&&!i?e.jsx("div",{className:"flex flex-col items-center justify-center h-32 text-gray-300 border-2 border-dashed border-gray-100 rounded-2xl",children:e.jsx("span",{className:"text-xs",children:"업무 없음"})}):n.map((d,N)=>e.jsx(H,{task:d,index:N,draggedTaskId:p,onClick:a,onDragStart:b,onDragEnd:x,onDelete:D,onArchive:h&&l===w.DONE?h:void 0},d.id)),i&&n.length===0&&e.jsx("div",{className:"h-32 rounded-2xl border-2 border-dashed border-blue-200 bg-blue-50/30 flex items-center justify-center",children:e.jsx("span",{className:"text-blue-400 text-sm font-medium",children:"여기에 놓으세요"})})]})]})},J=({tasks:l,onTaskClick:u,onStatusChange:g,onDeleteTask:n,onArchiveTask:p,onArchiveAll:f,currentUser:a})=>{const[b,x]=m.useState(null),[s,o]=m.useState(null),[y,D]=m.useState(""),[h,v]=m.useState("ALL"),[i,d]=m.useState(!1),[N,E]=m.useState("NONE"),S=m.useMemo(()=>{const t=l.filter(r=>!r.archived&&!r.inTrash);return P(t,{query:y,priority:h,onlyMyTasks:i,currentUserId:(a==null?void 0:a.uid)||"u1"},N)},[l,y,h,i,N,a]),C=(t,r)=>{x(r),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",r);const c=t.target;setTimeout(()=>c.classList.add("opacity-50","scale-95","grayscale"),0)},k=t=>{x(null),o(null),t.target.classList.remove("opacity-50","scale-95","grayscale")},O=(t,r)=>{t.preventDefault(),s!==r&&o(r)},A=()=>{o(null)},I=(t,r)=>{t.preventDefault();const c=t.dataTransfer.getData("text/plain");c&&g(c,r),o(null),x(null)};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx(_,{searchQuery:y,setSearchQuery:D,onlyMyTasks:i,setOnlyMyTasks:d,filterPriority:h,setFilterPriority:v,sortBy:N,setSortBy:E}),e.jsx("div",{className:"flex gap-8 h-full min-w-max pb-4 flex-1",children:R.map(t=>{const r=S.filter(c=>t.id===w.CHECKED?c.status===w.CHECKED||c.status==="SENT":c.status===t.id);return e.jsx(z,{id:t.id,label:t.label,dotColor:t.dotColor,tasks:r,draggedTaskId:b,dragOverColumn:s,onTaskClick:u,onDragStart:C,onDragEnd:k,onDragOver:O,onDragLeave:A,onDrop:I,onDeleteTask:n,onArchiveTask:p,onArchiveAll:f},t.id)})})]})};export{J as KanbanBoard};
